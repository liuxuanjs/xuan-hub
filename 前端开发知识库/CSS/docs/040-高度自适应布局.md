## 概述

高度自适应布局是一种常见的布局需求，通常表现为固定高度的头部/底部区域和自适应高度的内容区域。实现方式有多种，各有优缺点。

## 问题场景

**典型结构：**
```html
<div class="container">
    <div class="header">固定高度区域（100px）</div>
    <div class="content">自适应高度区域</div>
</div>
```

**目标：** 让`.content`填满除`.header`外的剩余空间

## 解决方案

### 1. 绝对定位方案

```css
.container {
    position: relative;
    height: 100vh; /* 或指定具体高度 */
}

.header {
    height: 100px;
    background: #f0f0f0;
    /* 正常文档流 */
}

.content {
    position: absolute;
    top: 100px;
    bottom: 0;
    left: 0;
    right: 0;
    background: #e0e0e0;
    overflow-y: auto;
}
```

**优点：**
- 兼容性极好，支持所有浏览器
- 实现简单直观

**缺点：**
- 内容区域脱离文档流
- 需要手动指定top值
- 不适合复杂布局

### 2. Flexbox方案（推荐）

```css
.container {
    display: flex;
    flex-direction: column;
    height: 100vh;
}

.header {
    height: 100px;
    background: #f0f0f0;
    flex-shrink: 0; /* 防止收缩 */
}

.content {
    flex: 1; /* 等同于 flex-grow: 1 */
    background: #e0e0e0;
    overflow-y: auto;
}
```

**优点：**
- 语义清晰，易于理解
- 自动计算剩余空间
- 响应式友好

**缺点：**
- IE10+才支持
- 需要了解flex属性

### 3. CSS Grid方案

```css
.container {
    display: grid;
    grid-template-rows: 100px 1fr;
    height: 100vh;
}

.header {
    background: #f0f0f0;
}

.content {
    background: #e0e0e0;
    overflow-y: auto;
}
```

**优点：**
- 最简洁的代码
- 强大的二维布局能力
- 语义最清晰

**缺点：**
- IE不支持
- 相对较新的技术

### 4. calc()计算方案

```css
.container {
    height: 100vh;
}

.header {
    height: 100px;
    background: #f0f0f0;
}

.content {
    height: calc(100vh - 100px);
    background: #e0e0e0;
    overflow-y: auto;
}
```

**优点：**
- 计算精确
- 不改变布局流

**缺点：**
- 需要手动计算
- 容器高度变化时需要更新

## 复杂场景应用

### 三栏布局（头部+内容+底部）

```css
.container {
    display: flex;
    flex-direction: column;
    height: 100vh;
}

.header {
    height: 60px;
    background: #333;
    color: white;
}

.main {
    flex: 1;
    display: flex;
    min-height: 0; /* 重要：允许flex项目收缩 */
}

.sidebar {
    width: 200px;
    background: #f5f5f5;
}

.content {
    flex: 1;
    background: white;
    overflow-y: auto;
}

.footer {
    height: 40px;
    background: #666;
    color: white;
}
```

### 响应式自适应

```css
.container {
    display: flex;
    flex-direction: column;
    height: 100vh;
}

/* 移动端：垂直布局 */
@media (max-width: 768px) {
    .header {
        height: 50px;
    }
}

/* 桌面端：可能需要更大的头部 */
@media (min-width: 1024px) {
    .header {
        height: 80px;
    }
}

.content {
    flex: 1;
    overflow-y: auto;
    padding: 20px;
}
```

### 动态高度头部

```css
.container {
    display: flex;
    flex-direction: column;
    height: 100vh;
}

.header {
    /* 不设置固定高度，让内容决定 */
    background: #f0f0f0;
    padding: 20px;
    flex-shrink: 0;
}

.content {
    flex: 1;
    overflow-y: auto;
    min-height: 0; /* 确保可以收缩 */
}
```

## JavaScript动态调整

```javascript
// 动态计算并设置高度
function adjustContentHeight() {
    const container = document.querySelector('.container');
    const header = document.querySelector('.header');
    const content = document.querySelector('.content');
    
    const containerHeight = container.offsetHeight;
    const headerHeight = header.offsetHeight;
    const contentHeight = containerHeight - headerHeight;
    
    content.style.height = contentHeight + 'px';
}

// 监听窗口大小变化
window.addEventListener('resize', adjustContentHeight);

// 监听内容变化（如果头部高度可能改变）
const observer = new ResizeObserver(adjustContentHeight);
observer.observe(document.querySelector('.header'));
```

## 兼容性方案

```css
/* 渐进增强方案 */
.container {
    height: 100vh;
}

/* 回退方案：绝对定位 */
.content {
    position: absolute;
    top: 100px;
    bottom: 0;
    left: 0;
    right: 0;
    overflow-y: auto;
}

/* 现代浏览器：使用flexbox */
@supports (display: flex) {
    .container {
        display: flex;
        flex-direction: column;
    }
    
    .header {
        flex-shrink: 0;
    }
    
    .content {
        position: static;
        flex: 1;
        top: auto;
        bottom: auto;
        left: auto;
        right: auto;
    }
}
```

## 性能考虑

### 滚动性能优化

```css
.content {
    flex: 1;
    overflow-y: auto;
    
    /* 滚动性能优化 */
    -webkit-overflow-scrolling: touch;
    transform: translateZ(0);
    will-change: scroll-position;
}
```

### 内容渲染优化

```css
.content {
    flex: 1;
    overflow-y: auto;
    
    /* 减少重绘 */
    contain: layout style paint;
    
    /* 虚拟化长列表 */
    content-visibility: auto;
}
```

## 最佳实践建议

1. **优先选择Flexbox：** 现代项目推荐使用flex布局
2. **考虑兼容性：** 需要支持老浏览器时使用绝对定位
3. **响应式设计：** 结合媒体查询适配不同屏幕
4. **性能优化：** 为滚动区域添加适当的性能优化属性
5. **语义化：** 选择最符合布局语义的解决方案

## 标签
#CSS #前端面试