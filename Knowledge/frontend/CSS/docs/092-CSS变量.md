# CSS变量

## 概述
CSS变量（CSS Custom Properties）是CSS的原生变量系统，允许定义可重用的值，提高代码的可维护性和灵活性。

## 基本语法

### 定义变量
```css
:root {
    --primary-color: #007bff;       /* 定义全局变量 */
    --font-size: 16px;
    --border-radius: 4px;
    --spacing: 20px;
}
```

### 使用变量
```css
.button {
    background-color: var(--primary-color);    /* 使用变量 */
    font-size: var(--font-size);
    border-radius: var(--border-radius);
    padding: var(--spacing);
}
```

### 带默认值
```css
.element {
    color: var(--text-color, #333);           /* 如果未定义则使用#333 */
    margin: var(--margin, 10px 20px);         /* 默认值可以是多个值 */
}
```

## 变量作用域

### 全局变量
```css
:root {
    --global-color: blue;      /* 全局变量 */
}
```

### 局部变量
```css
.component {
    --local-color: red;        /* 只在.component内有效 */
    color: var(--local-color);
}

.component .child {
    color: var(--local-color); /* 子元素可以继承 */
}
```

### 作用域覆盖
```css
:root {
    --color: blue;             /* 全局定义 */
}

.special {
    --color: red;              /* 局部覆盖 */
    color: var(--color);       /* 使用red */
}
```

## 实际应用场景

### 1. 主题系统
```css
/* 默认主题 */
:root {
    --bg-color: #ffffff;
    --text-color: #333333;
    --primary-color: #007bff;
    --border-color: #e0e0e0;
}

/* 深色主题 */
[data-theme="dark"] {
    --bg-color: #1a1a1a;
    --text-color: #ffffff;
    --primary-color: #4da6ff;
    --border-color: #404040;
}

/* 组件使用变量 */
.card {
    background: var(--bg-color);
    color: var(--text-color);
    border: 1px solid var(--border-color);
}
```

### 2. 响应式设计
```css
:root {
    --container-width: 1200px;
    --grid-columns: 4;
    --gap: 20px;
}

@media (max-width: 768px) {
    :root {
        --container-width: 100%;
        --grid-columns: 2;
        --gap: 10px;
    }
}

.grid {
    max-width: var(--container-width);
    display: grid;
    grid-template-columns: repeat(var(--grid-columns), 1fr);
    gap: var(--gap);
}
```

### 3. 组件系统
```css
/* 按钮组件 */
.btn {
    --btn-padding: 8px 16px;
    --btn-border-radius: 4px;
    --btn-font-weight: 500;
    
    padding: var(--btn-padding);
    border-radius: var(--btn-border-radius);
    font-weight: var(--btn-font-weight);
    border: none;
    cursor: pointer;
}

/* 按钮变体 */
.btn-large {
    --btn-padding: 12px 24px;
}

.btn-rounded {
    --btn-border-radius: 50px;
}
```

### 4. 动画和过渡
```css
:root {
    --transition-duration: 0.3s;
    --transition-easing: ease-in-out;
}

.smooth {
    transition: all var(--transition-duration) var(--transition-easing);
}

.btn:hover {
    --btn-bg: #0056b3;         /* 动态改变变量值 */
    background: var(--btn-bg);
}
```

## 高级用法

### 1. 计算和组合
```css
:root {
    --base-size: 16px;
    --scale: 1.25;
}

.h1 { font-size: calc(var(--base-size) * var(--scale) * var(--scale)); }
.h2 { font-size: calc(var(--base-size) * var(--scale)); }
.body { font-size: var(--base-size); }
```

### 2. 颜色系统
```css
:root {
    --primary-h: 210;          /* 色相 */
    --primary-s: 100%;         /* 饱和度 */
    --primary-l: 50%;          /* 亮度 */
    
    --primary: hsl(var(--primary-h), var(--primary-s), var(--primary-l));
    --primary-light: hsl(var(--primary-h), var(--primary-s), 70%);
    --primary-dark: hsl(var(--primary-h), var(--primary-s), 30%);
}
```

### 3. 空间系统
```css
:root {
    --space-unit: 4px;
    --space-xs: var(--space-unit);        /* 4px */
    --space-sm: calc(var(--space-unit) * 2); /* 8px */
    --space-md: calc(var(--space-unit) * 4); /* 16px */
    --space-lg: calc(var(--space-unit) * 6); /* 24px */
    --space-xl: calc(var(--space-unit) * 8); /* 32px */
}
```

## JavaScript交互

### 读取CSS变量
```javascript
// 获取CSS变量值
const primaryColor = getComputedStyle(document.documentElement)
    .getPropertyValue('--primary-color');

console.log(primaryColor); // "#007bff"
```

### 设置CSS变量
```javascript
// 设置CSS变量
document.documentElement.style.setProperty('--primary-color', '#28a745');

// 或者在特定元素上设置
element.style.setProperty('--local-var', 'red');
```

### 主题切换
```javascript
function toggleTheme() {
    const current = document.documentElement.dataset.theme;
    document.documentElement.dataset.theme = 
        current === 'dark' ? 'light' : 'dark';
}
```

## 实用技巧

### 1. 调试变量
```css
/* 显示变量值 */
.debug::before {
    content: 'Primary: ' var(--primary-color);
    position: absolute;
    background: yellow;
    padding: 5px;
}
```

### 2. 变量命名规范
```css
:root {
    /* 颜色变量 */
    --color-primary: #007bff;
    --color-secondary: #6c757d;
    --color-success: #28a745;
    
    /* 尺寸变量 */
    --size-xs: 0.75rem;
    --size-sm: 0.875rem;
    --size-md: 1rem;
    
    /* 阴影变量 */
    --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
    --shadow-md: 0 4px 6px rgba(0,0,0,0.1);
}
```

### 3. 组件封装
```css
/* 卡片组件 */
.card {
    --card-bg: var(--color-surface, #fff);
    --card-border: var(--color-border, #e0e0e0);
    --card-radius: var(--radius-md, 8px);
    --card-padding: var(--space-md, 16px);
    --card-shadow: var(--shadow-sm, 0 1px 3px rgba(0,0,0,0.1));
    
    background: var(--card-bg);
    border: 1px solid var(--card-border);
    border-radius: var(--card-radius);
    padding: var(--card-padding);
    box-shadow: var(--card-shadow);
}
```

## 浏览器兼容性

### 支持情况
- Chrome 49+
- Firefox 31+  
- Safari 9.1+
- IE/Edge不支持

### 兼容性处理
```css
/* 降级方案 */
.button {
    background: #007bff;              /* 降级值 */
    background: var(--primary-color); /* 现代浏览器 */
}

/* 或使用@supports */
@supports (--css: variables) {
    .modern {
        color: var(--text-color);
    }
}
```

## 与预处理器对比

### CSS变量 vs Sass变量

| 特性 | CSS变量 | Sass变量 |
|------|---------|----------|
| 运行时 | ✅ 可动态改变 | ❌ 编译时确定 |
| 作用域 | ✅ 支持级联 | ❌ 全局/局部 |
| JavaScript | ✅ 可操作 | ❌ 不可操作 |
| 浏览器支持 | ❌ 有限制 | ✅ 编译后兼容 |

## 总结

CSS变量的核心优势：

1. **动态性**：运行时可以修改值
2. **级联性**：遵循CSS的级联规则
3. **JavaScript交互**：可以通过JS读写
4. **作用域控制**：支持全局和局部变量
5. **主题系统**：轻松实现主题切换
6. **响应式友好**：配合媒体查询使用

CSS变量为现代CSS开发提供了强大的动态能力，是构建可维护样式系统的重要工具。