## 概述

CSS 优先级算法决定了当多个样式规则应用到同一个元素时，哪个规则会生效。优先级是基于选择器的特殊性值计算的，理解优先级计算规则对于编写可维护的 CSS 代码至关重要。优先级系统确保了样式的可预测性和层叠规则的正确应用。

## 优先级等级系统

### !important 声明

**语法：** `property: value !important`

**特点：**

- 拥有最高优先级
- 覆盖所有其他声明
- 不参与特殊性值计算
- 只能被其他 `!important` 声明覆盖

**特殊性值：** 可理解为 `1,0,0,0,0`

**使用场景：** 强制应用关键样式，但应谨慎使用

### 行内样式（内联样式）

**语法：** `<div style="color: red;">`

**特点：**

- 直接写在 HTML 元素的 `style` 属性中
- 优先级仅次于 `!important`
- 特殊性值为 `1,0,0,0`
- 难以维护和覆盖

**使用场景：** 动态样式设置，临时样式覆盖

### ID 选择器

**语法：** `#myId`

**特点：**

- 通过元素 ID 选择
- 特殊性值为 `0,1,0,0`
- 每个 ID 选择器增加 1 到 ID 位
- 优先级高于类选择器

**示例：**

```css
#demo a {
  color: orange;
} /* 特殊性值：0,1,0,1 */
div#demo a {
  color: red;
} /* 特殊性值：0,1,0,2 */
```

**使用场景：** 选择唯一元素的特定样式

### 类选择器、属性选择器、伪类选择器

**语法：** `.class`、`[attr="value"]`、`:hover`

**特点：**

- 特殊性值为 `0,0,1,0`
- 每个此类选择器增加 1 到类位
- 包括类选择器、属性选择器、伪类选择器
- 可复用性强

**示例：**

```css
.nav .item:hover {
} /* 特殊性值：0,0,3,0 */
[data-type="button"] {
} /* 特殊性值：0,0,1,0 */
```

**使用场景：** 通用样式设置，组件样式定义

### 元素选择器、伪元素选择器

**语法：** `div`、`::before`

**特点：**

- 特殊性值为 `0,0,0,1`
- 每个此类选择器增加 1 到元素位
- 包括标签选择器和伪元素选择器
- 优先级最低（除通配符外）

**示例：**

```css
div p::before {
} /* 特殊性值：0,0,0,3 */
```

**使用场景：** 基础元素样式设置

### 通配符选择器

**语法：** `*`

**特点：**

- 特殊性值为 `0,0,0,0`
- 优先级高于继承样式
- 不增加任何特殊性值
- 常用于样式重置

**使用场景：** 全局样式重置

### 继承样式

**特点：**

- 没有特殊性值
- 优先级最低
- 可被任何直接声明覆盖
- 从父元素继承而来

**使用场景：** 自动继承的样式属性

## 优先级计算规则

### 特殊性值累加规则

**计算方法：**

- 每个等级初始值为 0
- 每个等级独立计数，不可进位
- 选择器出现次数相加到对应等级
- 最终形成四位数值：`a,b,c,d`

**特点：**

- 不同等级之间不会进位（如 `0,99,99,99` 不会变成 `1,0,0,0`）
- 每个等级独立比较
- 从左到右依次比较各等级数值

**使用场景：** 精确计算复杂选择器优先级

### 优先级比较规则

**比较顺序：**

1. 首先比较 `!important` 声明
2. 然后从左到右比较特殊性值各位
3. 如果特殊性值相同，比较声明顺序
4. 后声明的规则优先级更高

**特点：**

- 左侧数值大的规则优先级更高
- 同一位数值相同时比较下一位
- 特殊性值完全相同时按声明顺序决定

**使用场景：** 确定多个规则的生效顺序

### 计算示例

**示例分析：**

```css
/* 示例 1 */
#nav .item a:hover {
} /* 0,1,2,1 */
div#nav .active .item a {
} /* 0,1,2,2 */

/* 示例 2 */
.nav .menu .item {
} /* 0,0,3,0 */
#content .item {
} /* 0,1,1,0 */
```

**特点：**

- 示例 1 中第二个规则优先级更高（元素选择器数量更多）
- 示例 2 中第二个规则优先级更高（ID 选择器权重更大）

**使用场景：** 复杂选择器组合的优先级判断

## 优先级最佳实践

### 避免过度使用 !important

**原则：**

- 尽量避免使用 `!important`
- 通过合理的选择器设计控制优先级
- 必要时使用更具体的选择器

**使用场景：** 第三方样式覆盖，紧急样式修复

### 合理的优先级层次设计

**策略：**

- 基础样式使用元素选择器
- 组件样式使用类选择器
- 特殊状态使用组合选择器
- 避免过于复杂的选择器链

**使用场景：** 大型项目样式架构设计

## 标签

#CSS #前端面试
